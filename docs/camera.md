### Суть `CameraBase`

Этот класс хранит внутренние параметры камеры и умеет работать с ними в самых типовых сценариях:

1. **Геометрия камеры**

   * Матрица K (`fx, fy, cx, cy`)
   * Коэффициенты дисторсии
   * Границы изображения
   * Углы обзора (перевод через `focal2fov`)

2. **Базовые проверки и операции**

   * Проверка попадания пикселя в изображение (`is_in_image`)
   * Векторная версия для массивов (`are_in_image`)
   * Получение матрицы внутренних параметров и её обратной

3. **Интеграция с графикой**

   * Функция генерации матрицы проекции для OpenGL/Open3D (нужна для рендеринга карты, отладки или симуляций).

### Суть `PinholeCamera`

Это расширение для pinhole-модели (модель камеры-обскуры без сложных искажений). Она вводит ключевые вещи для SLAM:

1. **Проекция**

   * Перевод 3D точек в 2D (`project`)
   * Поддержка стерео (`project_stereo`) через `bf = baseline * fx`, что позволяет вычислять правую проекцию и работать с disparity.

2. **Обратная проекция**

   * Из пикселя в нормализованные координаты (`unproject`)
   * Из пикселя и глубины в 3D (`unproject_3d`)
   * Векторизованные версии для массивов точек

3. **Коррекция искажений**

   * Убирает дисторсию у точек (`undistort_points`)
   * Пересчитывает рабочие границы изображения после undistort (`undistort_image_bounds`)

Таким образом, `PinholeCamera` — это связующее звено между сырыми изображениями и математикой SLAM: с его помощью можно проецировать map-points в кадры, проверять их видимость, триангулировать новые точки и корректно работать с disparity/глубиной.

### Что можно ещё сделать

1. **Поддержка разных моделей камеры**
   Сейчас есть только pinhole + простая дисторсия. Можно расширить:

   * fisheye (с отдельными функциями `cv2.fisheye`)
   * катадиоптрические камеры (360°, сферические модели)

2. **Интеграция с калибровкой**
   Автоматическая инициализация из объектов `MonoCalibration` и `StereoCalibration`, чтобы не собирать параметры руками.

3. **Поддержка временной информации**
   Добавить поле `fps` или тайминг, если камера используется вместе с источником (`DatasetSource`, `CameraSource`).

4. **Удобные утилиты**

   * Преобразование из K и baseline прямо в Q-матрицу (для `cv2.reprojectImageTo3D`).
   * Экспорт параметров в словарь/YAML (для сохранения конфигураций).
   * Визуализация FOV/плоскости изображения в Open3D.

5. **Интеграция с SLAM**

   * Методы для быстрого вычисления epipolar geometry (например, построение матрицы essential/fundamental из пары камер).
   * Проверка консистентности наблюдений (например, сравнение reprojection error).

### Суть для пайплайна

* `CameraBase` и `PinholeCamera` задают **математическую модель камеры**.
* Эта модель напрямую используется при:

  * коррекции искажений входных кадров,
  * триангуляции новых 3D-точек,
  * проверке качества карт (reprojection error),
  * построении disparity/глубины (через baseline и fx).
